{
  "name" : "poc-dw-dim-delaership",
  "description" : "",
  "role" : "arn:aws:iam::292923181097:role/LakeFormationWorkflowRole",
  "executionProperty" : {
    "maxConcurrentRuns" : 10
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-292923181097-us-east-1/scripts/poc-dw-dim-delaership.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--spark-event-logs-path" : "s3://aws-glue-assets-292923181097-us-east-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-glue-datacatalog" : "true",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-bookmark-option" : "job-bookmark-enable",
    "--job-language" : "python",
    "--TempDir" : "s3://aws-glue-assets-292923181097-us-east-1/temporary/"
  },
  "connections" : {
    "connections" : [ "redshift-dw-rpt-tableau", "mysql-eblock-4" ]
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 10,
  "timeout" : 2880,
  "maxCapacity" : 10.0,
  "glueVersion" : "3.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "executionClass" : "STANDARD",
  "codeGenConfigurationNodes" : "{\"node-1671215035356\":{\"SparkSQL\":{\"Inputs\":[\"node-1671214882512\",\"node-1671214936599\"],\"Name\":\"mv_aug_consigner_login\",\"SqlAliases\":[{\"Alias\":\"user_consigner\",\"From\":\"node-1671214882512\"},{\"Alias\":\"user_login\",\"From\":\"node-1671214936599\"}],\"SqlQuery\":\"select consigner_id, min(first_login) as first_login, max(last_login) as last_login\\nfrom user_consigner\\n         inner join user_login\\n                    on user_consigner.user_id = user_login.user_id\\ngroup by 1;\\n\"}},\"node-1671214936599\":{\"DirectJDBCSource\":{\"ConnectionName\":\"redshift-dw-rpt-tableau\",\"ConnectionType\":\"redshift\",\"Database\":\"dev\",\"Name\":\"user_login\",\"RedshiftTmpDir\":\"s3://einc-raw.datalake.reporting-dev.e.inc/tmp/\",\"Table\":\"dw.user_login\"}},\"node-1671215340607\":{\"MySQLCatalogSource\":{\"Database\":\"mysql-eblock\",\"Name\":\"consigner\",\"Table\":\"eblock_consigner\"}},\"node-1671215218546\":{\"MySQLCatalogSource\":{\"Database\":\"mysql-eblock\",\"Name\":\"location\",\"Table\":\"eblock_location\"}},\"node-1671215177824\":{\"MySQLCatalogSource\":{\"Database\":\"mysql-eblock\",\"Name\":\"consigner\",\"Table\":\"eblock_consigner\"}},\"node-1671215439106\":{\"SparkSQL\":{\"Inputs\":[\"node-1671215177824\",\"node-1671215218546\",\"node-1671215340607\",\"node-1671215397284\",\"node-1671215035356\"],\"Name\":\"SQL Query\",\"SqlAliases\":[{\"Alias\":\"consigner\",\"From\":\"node-1671215177824\"},{\"Alias\":\"location\",\"From\":\"node-1671215218546\"},{\"Alias\":\"consigner\",\"From\":\"node-1671215340607\"},{\"Alias\":\"territory\",\"From\":\"node-1671215397284\"},{\"Alias\":\"mv_aug_consigner_login\",\"From\":\"node-1671215035356\"}],\"SqlQuery\":\"select dealership.id                                                                        as dealership_id,\\n       dealership.name                                                                      as dealership_name,\\n       from_utc_timestamp(dealership.created, \\\"US/Eastern\\\")                                 as dealership_created,     \\n       dealership.sub_type                                                                  as dealership_sub_type,\\n       dealership.type                                                                      as dealership_type,\\n       dealership.archived                                                                  as dealership_archived,\\n       dealership.status                                                                    as dealership_status,\\n       dealership.source                                                                    as dealership_source,\\n       dealership.zoho_id                                                                   as dealership_zoho_id,\\n       dealership.dealer_number                                                             as dealership_dealer_number,\\n       dealership.dealer_number_us                                                          as dealership_dealer_number_us,\\n       dealership.rin                                                                       as dealership_rin,\\n       dealership.whitelisted_region_codes                                                  as dealership_whitelisted_region_codes,\\n       dealership.visible_region                                                            as dealership_visible_region,\\n       dealership_parent.name                                                               as dealership_parent_name,\\n       dealership_parent.id                                                                 as dealership_parent_id,\\n       dealership_location.name                                                             as dealership_location_name,\\n       dealership_location.street_number                                                    as dealership_location_street_number,\\n       dealership_location.street_name                                                      as dealership_location_street_name,\\n       dealership_location.city                                                             as dealership_location_city,\\n       dealership_location.region                                                           as dealership_location_region,\\n       dealership_location.region_code                                                      as dealership_location_region_code,\\n       dealership_location.country                                                          as dealership_location_country,\\n       dealership_location.country_code                                                     as dealership_location_country_code,\\n       dealership_location.zip_code                                                         as dealership_location_zip_code,\\n       case\\n           when dealership_location.country_code = 'US' and dealership_location.country = 'United States' and\\n                dealership_location.zip_code is not null\\n               then right('00000' || left(dealership_location.zip_code, 5), 5)\\n           when dealership_location.country_code = 'CA' and dealership_location.country = 'Canada'\\n               then upper(left(dealership_location.zip_code, 3))\\n           else dealership_location.country_code || '-' || dealership_location.zip_code end as dealership_territory_zip_code,\\n       dealership_territory.territory                                                       as dealership_territory_territory,\\n       dealership_territory.district                                                        as dealership_territory_district,\\n       dealership_territory.region                                                          as dealership_territory_region,\\n       dealership_territory.rsm_name                                                        as dealership_territory_rsm_name,\\n       dealership_territory.rsm_user_id                                                     as dealership_territory_rsm_user_id,\\n       dealership_territory.tsm_name                                                        as dealership_territory_tsm_name,\\n       dealership_territory.tsm_user_id                                                     as dealership_territory_tsm_user_id,\\n       dealership_login.first_login                                                         as dealership_first_login,\\n       dealership_login.last_login                                                          as dealership_last_login\\nfrom  consigner as dealership\\n         left join  location dealership_location\\n                   on dealership.location_id = dealership_location.id\\n         left join  consigner dealership_parent\\n                   on dealership.parent_company_id = dealership_parent.id\\n         left join  mv_aug_consigner_login dealership_login\\n                   on dealership.id = dealership_login.consigner_id\\n         left join  territory dealership_territory\\n                   on (case\\n                           when dealership_location.country_code = 'US' and\\n                                dealership_location.country = 'United States' and\\n                                dealership_location.zip_code is not null\\n                               then right('00000' || left(dealership_location.zip_code, 5), 5)\\n                           when dealership_location.country_code = 'CA' and dealership_location.country = 'Canada'\\n                               then upper(left(dealership_location.zip_code, 3))\\n                           else dealership_location.country_code || '-' || dealership_location.zip_code end) =\\n                      dealership_territory.zip_code;\\t\\n\\n\\n\"}},\"node-1671215397284\":{\"DirectJDBCSource\":{\"ConnectionName\":\"redshift-dw-rpt-tableau\",\"ConnectionType\":\"redshift\",\"Database\":\"dev\",\"Name\":\"territory\",\"RedshiftTmpDir\":\"s3://einc-raw.datalake.reporting-dev.e.inc/tmp/\",\"Table\":\"staging.territory\"}},\"node-1671214882512\":{\"MySQLCatalogSource\":{\"Database\":\"mysql-eblock\",\"Name\":\"user_consigner\",\"Table\":\"eblock_user_consigner\"}},\"node-1671216087646\":{\"RedshiftTarget\":{\"Database\":\"dw\",\"Inputs\":[\"node-1671215439106\"],\"Name\":\"Amazon Redshift\",\"RedshiftTmpDir\":\"\",\"Table\":\"dev_dw_dim_dealership\",\"UpsertRedshiftOptions\":{\"ConnectionName\":\"redshift-dw-rpt-tableau\",\"TableLocation\":\"dev.dw.dim_dealership\",\"UpsertKeys\":[\"dealership_id\"]}}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "GlueCiCdDemo",
    "branch" : "main",
    "folder" : "poc-dw-dim-delaership"
  }
}